<?xml version="1.0" encoding="utf-8"?>
<DayEntry xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="urn:newtelligence-com:dasblog:runtime:data">
  <Date>2005-10-29T02:00:00+02:00</Date>
  <Entries>
    <Entry>
      <Content>&lt;p&gt;&lt;a href="http://www.pc-bibliothek.de/"&gt;PC-Bibliothek&lt;/a&gt; is a powerful (and yet not LUA-compatible [1]) application that acts as&amp;nbsp;your personal digital library. There's a wide variety of &lt;a href="http://www.pc-bibliothek.de/index2.html?pc-bibliothek/st_titel.html"&gt;extensions&lt;/a&gt; like dictionaries and encyclopaedias available.&lt;/p&gt;
&lt;p align="center"&gt;&lt;img alt="PC-Bibliothek Screenshot" src="http://www.it99.org/axl/content/binary/PC-Bibliothek%20Screenshot.png" border="0"&gt;&lt;/p&gt;
&lt;p&gt;One drawback that bugged me for the last months is that there's no documented way to hand over a&amp;nbsp;search string to the application. You'll either have to type or copy/paste the search term or use their annoying tray application to perform a quick search. Not to speak of browser integration. This application is virtually isolated from the rest of the world. And yet I like it for it's outstandingly good&amp;nbsp;content.&lt;/p&gt;
&lt;p&gt;This is when the dev in me awakes :-) I've written a little app, PCBibStarter, that's able to invoke PC-Bibliothek and set the search term in the "Search for" edit box. I had to do it the dirty way by using the &lt;a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/windows/windowreference/windowfunctions/findwindowex.asp"&gt;FindWindowEx&lt;/a&gt; and &lt;a href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/messagesandmessagequeues/messagesandmessagequeuesreference/messagesandmessagequeuesfunctions/sendmessage.asp"&gt;SendMessage&lt;/a&gt; APIs. After PC-Bibliothek has started up, the app searches for the edit box that contains the search term. When the window has been found it sets the search term that has been passed to PCBibStarter as command line arguments.&lt;/p&gt;&lt;pre&gt;&lt;p&gt;&lt;span style="color: blue;"&gt;private&lt;/span&gt;&lt;span style="color: black;"&gt; &lt;/span&gt;&lt;span style="color: blue;"&gt;void&lt;/span&gt;&lt;span style="color: black;"&gt; SetKeyword(Process process, &lt;/span&gt;&lt;span style="color: blue;"&gt;string&lt;/span&gt;&lt;span style="color: black;"&gt; keyword)&lt;br&gt;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: blue;"&gt;using&lt;/span&gt;&lt;span style="color: black;"&gt;(process)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: blue;"&gt;try&lt;br&gt;&lt;/span&gt;&lt;span style="color: black;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: green;"&gt;// Wait for process to get idle (i.e. started up).&lt;br&gt;&lt;/span&gt;&lt;span style="color: black;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt;&lt;span style="color: black;"&gt; (process.WaitForInputIdle())&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br&gt;&lt;/span&gt;&lt;span style="color: black;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: green;"&gt;// Search tree of windows.&lt;br&gt;&lt;/span&gt;&lt;span style="color: black;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;...&lt;/span&gt;&lt;span style="color: black;"&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;&lt;/span&gt;&lt;span style="color: black;"&gt;&lt;br&gt;&lt;/span&gt;&lt;span style="color: black;"&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: green;"&gt;// Set search keyword.&lt;br&gt;&lt;/span&gt;&lt;span style="color: black;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;IntPtr result = NativeMethods.SendMessage(parent,&lt;span style="color: black;"&gt; &lt;/span&gt;NativeDeclarations.WM_SETTEXT, IntPtr.Zero, keyword);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: blue;"&gt;if&lt;/span&gt;&lt;span style="color: black;"&gt; (result == IntPtr.Zero)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: blue;"&gt;throw&lt;/span&gt;&lt;span style="color: black;"&gt; &lt;/span&gt;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&lt;span style="color: black;"&gt; ApplicationException(...&lt;/span&gt;&lt;span style="color: black;"&gt;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&lt;/span&gt;&lt;span style="color: black;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: blue;"&gt;else&lt;br&gt;&lt;/span&gt;&lt;span style="color: black;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: blue;"&gt;throw&lt;/span&gt;&lt;span style="color: black;"&gt; &lt;/span&gt;&lt;span style="color: blue;"&gt;new&lt;/span&gt;&lt;span style="color: black;"&gt; ApplicationException(&lt;/span&gt;&lt;span style="color: maroon;"&gt;...&lt;/span&gt;&lt;span style="color: black;"&gt;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: blue;"&gt;catch&lt;/span&gt;&lt;span style="color: black;"&gt;(Exception ex)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;MessageBox.Show(ex.ToString(), &lt;/span&gt;&lt;span style="color: maroon;"&gt;...&lt;/span&gt;&lt;span style="color: black;"&gt;);&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;/pre&gt;
&lt;p&gt;PCBibStarter reuses already running instances of PC-Bibliothek and sets the search terms accordingly. PC-Bibliothek now integrates well into &lt;a href="http://www.bayden.com/SlickRun/"&gt;SlickRun&lt;/a&gt; where I can type something like "bib my search term" to get PC-Bibliothek searching for "my search term" ("bib" acts as the &lt;a href="http://www.bayden.com/SlickRun/1033/SlickRunSetup.htm"&gt;magic word&lt;/a&gt;). Another nice feature is the&amp;nbsp;browser integration I am now able to come up with.&lt;/p&gt;
&lt;p align="center"&gt;&lt;img alt="PCBibStarter Browser Integration" src="http://www.it99.org/axl/content/binary/PCBibStarter%20Browser%20Integration%20Screenshot.png" border="0"&gt;&lt;/p&gt;
&lt;p&gt;This is accomplished by putting a JavaScript file besides the PCBibStarter executable that extracts the selected text out of a browser window using IE's DOM. PCBibStarter is then launched with the text as the command line argument. The JavaScript file has to be registered with IE by&amp;nbsp;adding a key under &lt;strong&gt;HKCU\Software\Microsoft\Internet Explorer\MenuExt&lt;/strong&gt; in the Registry.&lt;/p&gt;
&lt;p&gt;Almost the whole setup is done by the installer. However, there are two files you'll have to tweak. First, there's &lt;strong&gt;PCBibStarter.exe.config&lt;/strong&gt; that tells the location of your PC-Bibliothek installation.&lt;/p&gt;&lt;pre&gt;&lt;span style="color: blue;"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color: maroon;"&gt;xml &lt;/span&gt;&lt;span style="color: red;"&gt;version&lt;/span&gt;&lt;span style="color: blue;"&gt;="1.0" &lt;/span&gt;&lt;span style="color: red;"&gt;encoding&lt;/span&gt;&lt;span style="color: blue;"&gt;="utf-8" &lt;/span&gt;&lt;span style="color: blue;"&gt;?&amp;gt;&lt;br&gt;&lt;/span&gt;&lt;span style="color: maroon;"&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;configuration&lt;span style="color: blue;"&gt;&amp;gt;&lt;span&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: maroon;"&gt;&lt;span style="color: blue;"&gt;&amp;lt;&lt;/span&gt;appSettings&lt;font color="#0000ff"&gt;&amp;gt;&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&lt;span style="color: maroon;"&gt;&lt;span style="color: blue;"&gt;&lt;span style="color: blue;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: blue;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;/span&gt;add &lt;span style="color: red;"&gt;key&lt;/span&gt;&lt;span style="color: blue;"&gt;="Executable" &lt;span style="color: red;"&gt;value&lt;/span&gt;&lt;span style="color: blue;"&gt;="&lt;strong&gt;C:\Programme\PC-Bibliothek\pcbib_bi.exe&lt;/strong&gt;" /&lt;/span&gt;&lt;/span&gt;&lt;font color="#0000ff"&gt;&amp;gt;&lt;/font&gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="color: maroon;"&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;appSettings&lt;font color="#0000ff"&gt;&amp;gt;&lt;/font&gt;&lt;/span&gt;&lt;span style="color: blue;"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="color: maroon;"&gt;&lt;span style="color: blue;"&gt;&amp;lt;/&lt;/span&gt;configuration&lt;font color="#0000ff"&gt;&amp;gt;&lt;/font&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;Secondly, the JavaScript file containing the browser integration code, &lt;strong&gt;PCBibStarter.js&lt;/strong&gt;, has to be adjusted&amp;nbsp;to match the path of PCBibStarter. Note the double backslashes.&lt;/p&gt;&lt;pre&gt;shell.ShellExecute(&lt;span style="color: maroon;"&gt;"&lt;strong&gt;C:\\Programme\\PC-Bibliothek Starter\\PCBibStarter.exe&lt;/strong&gt;"&lt;/span&gt;&lt;span style="color: black;"&gt;,&amp;nbsp;selectedText, &lt;/span&gt;&lt;span style="color: maroon;"&gt;""&lt;/span&gt;&lt;span style="color: black;"&gt;, &lt;/span&gt;&lt;span style="color: maroon;"&gt;"open"&lt;/span&gt;&lt;span style="color: black;"&gt;, &lt;/span&gt;&lt;span style="color: maroon;"&gt;"1"&lt;/span&gt;&lt;span style="color: black;"&gt;);&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;img title="Download" class="download" style="margin-right: 4px;" alt="Download" src="http://www.it99.org/axl/content/binary/Download.gif"&gt;Here are the files:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PCBibStarter &lt;a href="http://www.it99.org/axl/download/PCBibStarter-1.0-Setup.zip"&gt;installer&lt;/a&gt;
&lt;/li&gt;&lt;li&gt;PCBibStarter &lt;a href="http://www.it99.org/axl/download/PCBibStarter-1.0-Source.zip"&gt;source code and VS project&lt;/a&gt;
&lt;/li&gt;&lt;li&gt;An &lt;a href="http://www.it99.org/axl/download/PC-Bibliothek.sdb.zip"&gt;application fix&lt;/a&gt; for PC-Bibliothek that adds LUA-awareness (install using &lt;strong&gt;sdbinst.exe PC-Bibliothek.sdb&lt;/strong&gt;)&lt;/li&gt;&lt;/ul&gt;
&lt;p&gt;[1] PC-Bibliothek stores its settings in an&amp;nbsp;&lt;strong&gt;ini&lt;/strong&gt; file inside of&amp;nbsp;&lt;strong&gt;%ProgramFiles%&lt;/strong&gt;. Limited User Accounts (LUAs) are not allowed to write to this location by default.&lt;/p&gt;</Content>
      <Created>2005-10-29T19:01:49.14+02:00</Created>
      <Modified>2006-12-16T20:43:30.8564438+01:00</Modified>
      <EntryId>05eccca4-64eb-4a6c-a5b4-f5b9325aa0bf</EntryId>
      <Description />
      <Title>A little Application to extend PC-Bibliothek</Title>
      <Categories>Tools and Software</Categories>
      <Author>agross</Author>
      <IsPublic>true</IsPublic>
      <Syndicated>true</Syndicated>
      <ShowOnFrontPage>true</ShowOnFrontPage>
      <AllowComments>true</AllowComments>
      <Attachments />
      <Crossposts />
      <Latitude xsi:nil="true" />
      <Longitude xsi:nil="true" />
    </Entry>
    <Entry>
      <Content>&lt;p&gt;This is what Google tells me when I navigate to their start page (&lt;a href="http://www.google.de/"&gt;www.google.de&lt;/a&gt;):&lt;/p&gt;
&lt;p align="center"&gt;&lt;img alt="Google Error Message" src="http://www.it99.org/axl/content/binary/Google%20Error%20Screenshot.png" border="0"&gt;&lt;/p&gt;
&lt;p&gt;I'm pretty sure my system is clean as neither &lt;a href="http://www.microsoft.com/athome/security/spyware/software/default.mspx"&gt;Microsoft AntiSpyware&lt;/a&gt; nor &lt;a href="http://www.lavasoftusa.com/software/adaware/"&gt;Ad-Aware&lt;/a&gt; reported spyware infections. Hopefully all other computers of our network are&amp;nbsp;not infected&amp;nbsp;as well.&lt;/p&gt;
&lt;p class="now-playing"&gt;Now playing: &lt;a href="http://www.music-map.de/oasis.html"&gt;Oasis&lt;/a&gt; - &lt;a href="http://www.amazon.com/exec/obidos/ASIN/B000068QY7/therightstu0e-20"&gt;Heathen Chemistry&lt;/a&gt; - (Probably) All in the mind&lt;/p&gt;</Content>
      <Created>2005-10-29T16:25:56.218+02:00</Created>
      <Modified>2008-06-10T12:07:03.0844997+02:00</Modified>
      <EntryId>6b6254d3-bc53-4343-af21-45e7ea89598d</EntryId>
      <Description />
      <Title>A strange Google Error Message</Title>
      <Categories>General</Categories>
      <Author>agross</Author>
      <IsPublic>true</IsPublic>
      <Syndicated>true</Syndicated>
      <ShowOnFrontPage>true</ShowOnFrontPage>
      <AllowComments>false</AllowComments>
      <Attachments />
      <Crossposts />
      <Latitude xsi:nil="true" />
      <Longitude xsi:nil="true" />
    </Entry>
  </Entries>
</DayEntry>