<?xml version="1.0" encoding="utf-8"?>
<DayEntry xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="urn:newtelligence-com:dasblog:runtime:data">
  <Date>2006-07-24T02:00:00.0000000+02:00</Date>
  <Entries>
    <Entry>
      <Content>&lt;p&gt;&lt;img title="pinvoke.net Logo" style="padding-left: 10px; float: right; padding-bottom: 10px;" alt="pinvoke.net Logo" src="http://www.it99.org/axl/content/binary/pinvoke.net%20Logo.png" border="0"&gt;The .NET Framework 2.0 has become pretty comprehensive compared to version 1.1. For example, Microsoft added features for &lt;a href="http://msdn2.microsoft.com/en-us/library/system.security.accesscontrol.filesecurity.aspx"&gt;ACLs&lt;/a&gt; in .NET 2.0. However, in some cases&amp;nbsp;us developers need a function not directly supported by the framework but by the underlying (Windows) operating system. &lt;a href="http://msdn2.microsoft.com/en-us/library/h50dxzwx.aspx"&gt;Platform Invoke&lt;/a&gt;, or P/Invoke for short, is a way to call Windows functions from&amp;nbsp;.NET code. First you'll have to declare the function by&amp;nbsp;finding out which&amp;nbsp;DLL contains the function and&amp;nbsp;the type of return value and parameters. When you have to do this more than twice a day, this can become nerve-racking.&lt;/p&gt;
&lt;p&gt;We live in a world of &lt;a href="http://en.wikipedia.org/wiki/Social_software"&gt;social software&lt;/a&gt;&amp;nbsp;and&amp;nbsp;&lt;a href="http://blogs.msdn.com/adam_nathan/"&gt;Adam Nathan&lt;/a&gt;&amp;nbsp;had the great idea of creating the &lt;a href="http://pinvoke.net/"&gt;pinvoke.net Wiki&lt;/a&gt; for the reason that nobody should be bothered with the tasks browsing MSDN for finding the correct&amp;nbsp;DLL and &lt;a href="http://msdn2.microsoft.com/en-us/library/ac7ay120.aspx"&gt;translate the&amp;nbsp;built-in Windows types to their .NET representation&lt;/a&gt; ...well, except the first one that uses a platform function :-) The Wiki is a great resource for P/Invoke declarations for&amp;nbsp;a wide variety of libraries and everyone is invited to post his own.&lt;/p&gt;
&lt;p&gt;To make the Wiki even more useful, Adam Nathan&amp;nbsp;&lt;a href="http://blogs.msdn.com/adam_nathan/archive/2004/05/06/127403.aspx"&gt;developed&lt;/a&gt;&amp;nbsp;the &lt;a href="http://www.gotdotnet.com/Community/UserSamples/Details.aspx?SampleGuid=75122f62-5459-4364-b9ba-7b5e6a4754fe"&gt;pinvoke.net Add-In for Visual Studio .NET 2003&lt;/a&gt;. I like it a lot and wondered why it hasn't been ported to Visual Studio 2005 for a long time.&amp;nbsp;Bernhard Elbl finally created a &lt;a href="http://gotdotnet.com/Community/UserSamples/Details.aspx?SampleGuid=91d1a529-0288-46d4-ae57-17446a6058f7"&gt;version for Visual Studio 2005&lt;/a&gt;&amp;nbsp;in May, and yesterday&amp;nbsp;I fortunately stumbled across it!&lt;/p&gt;
&lt;p&gt;However, I had a hard time installing it because I run an English version of Visual Studio 2005 on a German Windows XP. Visual Studio searches for Add-Ins in pre-defined folders that are &lt;em&gt;not&lt;/em&gt; localized to the OS language. You find these paths under Tools/Options/Environment/Add-In/Macros Security in Visual Studio 2005.&lt;/p&gt;
&lt;p align="center"&gt;&lt;a href="http://www.it99.org/axl/content/binary/Visual%20Studio%20Add-In%20Options.png"&gt;&lt;img title="Visual Studio Add-In Options" alt="Visual Studio Add-In Options" src="http://www.it99.org/axl/content/binary/Visual%20Studio%20Add-In%20Options%20small.png" border="0"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;As you see the first entry reads&lt;/p&gt;&lt;pre&gt;%ALLUSERSPROFILE%\&lt;strong&gt;Application Data&lt;/strong&gt;\Microsoft\MSEnvShared\Addins&lt;/pre&gt;
&lt;p&gt;On a German machine this should rather be&lt;/p&gt;&lt;pre&gt;%ALLUSERSPROFILE%\&lt;strong&gt;Anwendungsdaten&lt;/strong&gt;\Microsoft\MSEnvShared\Addins&lt;/pre&gt;
&lt;p&gt;You can either add a path containing your localized version of "Application Data" or move the &lt;strong&gt;pinvoke.net.AddIn&lt;/strong&gt; file to a folder that is contained in the search folder list.&lt;/p&gt;
&lt;p&gt;Happy P/Invoking!&lt;/p&gt;
&lt;p class="now-playing"&gt;Now playing: &lt;a href="http://www.music-map.de/madonna.html"&gt;Madonna&lt;/a&gt; - &lt;a href="http://www.amazon.com/exec/obidos/ASIN/B000B8QEZG/therightstu0e-20"&gt;Confessions on a dance floor&lt;/a&gt; - Jump&lt;/p&gt;</Content>
      <Created>2006-07-24T18:38:42.3350000+02:00</Created>
      <Modified>2006-12-16T20:34:45.1376938+01:00</Modified>
      <EntryId>3c36f610-b4d5-4b14-9dbe-b5055292079a</EntryId>
      <Description />
      <Title>pinvoke.net Add-In for Visual Studio 2005</Title>
      <Categories>Tools and Software;Visual Studio</Categories>
      <Author>agross</Author>
      <IsPublic>true</IsPublic>
      <Syndicated>true</Syndicated>
      <ShowOnFrontPage>true</ShowOnFrontPage>
      <AllowComments>true</AllowComments>
      <Attachments />
      <Crossposts />
    </Entry>
  </Entries>
</DayEntry>